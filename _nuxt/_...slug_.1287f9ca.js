import _sfc_main$2 from"./ContentRendererMarkdown.f8e274c5.js";import _sfc_main$3 from"./ContentRenderer.d50a0856.js";import{u as useCommandStore,a as ace}from"./useCommandStore.720f26cc.js";import{_ as _export_sfc,r as resolveComponent,o as openBlock,c as createElementBlock,a as createBaseVNode,b as createVNode,w as withCtx,d as createTextVNode,F as Fragment,f as useRoute,g as ref,s as storeToRefs,h as createBlock,t as toDisplayString,i as createCommentVNode,j as withKeys}from"./entry.8f704904.js";import{q as queryContent}from"./query.33e0d49e.js";import"./index.a6ef77ff.js";import"./preview.9538be7b.js";import"./_commonjsHelpers.042e6b4d.js";import"./utils.7997caff.js";let editor;const _sfc_main$1={setup(e){return{store:useCommandStore()}},data(){return{}},mounted(){editor=ace.edit("editorArea",{mode:"ace/mode/r",tabSize:4})},methods:{source(){this.store.updateCommand(editor.getValue().split(`
`))},save(){var e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(editor.getValue())),e.setAttribute("download","R_WASM.R"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}},_hoisted_1$1={class:"mb-2 text-left"},_hoisted_2$1={id:"editorArea",style:{height:"90%"},ref:"codeValue"};function _sfc_render$1(e,t,r,n,s,a){const l=resolveComponent("v-btn");return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$1,[createVNode(l,{onClick:a.save,size:"x-small","prepend-icon":"mdi-content-save",class:"mx-2",style:{"min-width":"100px"}},{default:withCtx(()=>[createTextVNode(" Save")]),_:1},8,["onClick"]),createVNode(l,{onClick:a.source,size:"x-small","prepend-icon":"mdi-play",class:"mx-2",style:{"min-width":"100px"}},{default:withCtx(()=>[createTextVNode(" Source")]),_:1},8,["onClick"])]),createBaseVNode("div",_hoisted_2$1,null,512)],64)}const __nuxt_component_2=_export_sfc(_sfc_main$1,[["render",_sfc_render$1]]);var M=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')}),ut=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},o=(e,t,r)=>(ut(e,t,"read from private field"),r?r.call(e):t.get(e)),u=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},c=(e,t,r,n)=>(ut(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),P=(e,t,r)=>(ut(e,t,"access private method"),r),f=typeof process<"u"&&process.release&&process.release.name==="node";if(!globalThis.document){if(!globalThis.importScripts){if(!f)throw new Error("Cannot determine runtime environment")}}function J(){let e={resolve:r=>{},reject:r=>{},promise:null},t=new Promise((r,n)=>{e.resolve=r,e.reject=n});return e.promise=t,e}function Ot(e){return new Promise(t=>setTimeout(t,e))}function E(e,t,r,...n){return e===null||typeof e!="object"?e:t(e)?r(e,...n):Array.isArray(e)||ArrayBuffer.isView(e)?e.map(s=>E(s,t,r,...n)):Object.fromEntries(Object.entries(e).map(([s,a],l)=>[s,E(a,t,r,...n)]))}function De(e,t){let r=new XMLHttpRequest;r.open("get",e,!0),r.onload=()=>{let n=new Worker(URL.createObjectURL(new Blob([r.responseText])));t(n)},r.send()}function V(e){if(f)return!1;let t=new URL(location.href),r=new URL(e,location.origin);return!(t.host===r.host&&t.port===r.port&&t.protocol===r.protocol)}var ur=new WeakMap;function Dt(e,t){return ur.set(e,t),e}var Me=63;function Ae(){let e=Array.from({length:4},cr).join("-");if(e.length!==Me)throw new Error("comlink internal error: UUID has the wrong length");return e}function cr(){let e=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16),t=15-e.length;return t>0&&(e=Array.from({length:t},()=>0).join("")+e),e}function Ce(e,t){return Mt({type:"request",data:{uuid:Ae(),msg:e}},t)}function Rt(e,t,r){return Mt({type:"response",data:{uuid:e,resp:t}},r)}function Mt(e,t){return t&&Dt(e,t),e}var Rr=new TextEncoder;new TextDecoder("utf-8");function je(e){return Rr.encode(JSON.stringify(e))}var dr=new TextEncoder;async function jt(e,t,r){try{let{taskId:n,sizeBuffer:s,dataBuffer:a,signalBuffer:l}=t,p=je(r),y=p.length<=a.length;if(Atomics.store(s,0,p.length),Atomics.store(s,1,+y),!y){let[x,$]=hr(e);a.set(dr.encode(x)),await Ct(l,n),a=(await $).dataBuffer}a.set(p),Atomics.store(s,1,1),await Ct(l,n)}catch(n){console.warn(n)}}function hr(e){let t=Ae();return[t,new Promise(r=>{f?e.once("message",n=>{!n.id||n.id!==t||r(n)}):e.addEventListener("message",function n(s){!s.data||!s.data.id||s.data.id!==t||(e.removeEventListener("message",n),r(s.data))}),e.start&&e.start()})]}async function Ct(e,t){let r=(t>>1)%32,n=1;for(;Atomics.compareExchange(e,r+1,0,t)!==0;)await Ot(n),n<32&&(n*=2);Atomics.or(e,0,1<<r),Atomics.notify(e,0)}var W,S,oe,yt,se=class{constructor(){u(this,oe),u(this,W,void 0),u(this,S,void 0),c(this,S,[]),c(this,W,[])}put(e){o(this,S).length||P(this,oe,yt).call(this),o(this,S).shift()(e)}async get(){return o(this,W).length||P(this,oe,yt).call(this),o(this,W).shift()}isEmpty(){return!o(this,W).length}isBlocked(){return!!o(this,S).length}get length(){return o(this,W).length-o(this,S).length}};W=new WeakMap,S=new WeakMap,oe=new WeakSet,yt=function(){o(this,W).push(new Promise(e=>{o(this,S).push(e)}))};function It(e){let t=new Error(e.obj.message);return t.name=e.obj.name,t.stack=e.obj.stack,t}function mr(e){return e&&typeof e=="object"&&"payloadType"in e&&"obj"in e}function Le(e){return mr(e)&&e.payloadType==="ptr"}var H,G=class{constructor(){this.inputQueue=new se,this.outputQueue=new se,u(this,H,new Map)}async read(){return await this.outputQueue.get()}async flush(){let e=[];for(;!this.outputQueue.isEmpty();)e.push(await this.read());return e}write(e){this.inputQueue.put(e)}async request(e,t){let r=Ce(e,t),{resolve:n,reject:s,promise:a}=J();return o(this,H).set(r.data.uuid,{resolve:n,reject:s}),this.write(r),a}resolveResponse(e){let t=e.data.uuid,r=o(this,H).get(t);if(r){let n=e.data.resp;o(this,H).delete(t),n.payloadType==="err"?r.reject(It(n)):r.resolve(n)}else console.warn("Can't find request.")}};H=new WeakMap;new TextDecoder("utf-8");var i={};function Bt(e){Object.keys(e).forEach(t=>i._free(e[t]))}f&&(globalThis.Worker=M("worker_threads").Worker);var Z,qe,qt,pe,le=class extends G{constructor(e){super(),u(this,qe),u(this,Z,void 0),this.close=()=>{},u(this,pe,async(r,n)=>{if(!(!n||!n.type))switch(n.type){case"resolve":c(this,Z,new Int32Array(n.data)),this.resolve();return;case"response":this.resolveResponse(n);return;default:this.outputQueue.put(n);return;case"sync-request":{let s=n,a=s.data.msg,l=s.data.reqData;switch(a.type){case"read":{let p=await this.inputQueue.get();await jt(r,l,p);break}default:throw new TypeError(`Unsupported request type '${a.type}'.`)}return}case"request":throw new TypeError("Can't send messages of type 'request' from a worker. Please Use 'sync-request' instead.")}});let t=r=>{P(this,qe,qt).call(this,r),this.close=()=>r.terminate();let n={type:"init",data:{config:e,channelType:O.SharedArrayBuffer}};r.postMessage(n)};if(V(e.baseUrl))De(`${e.baseUrl}webr-worker.js`,r=>t(r));else{let r=new Worker(`${e.baseUrl}webr-worker.js`);t(r)}({resolve:this.resolve,promise:this.initialised}=J())}interrupt(){if(!o(this,Z))throw new Error("Failed attempt to interrupt before initialising interruptBuffer");o(this,Z)[0]=1}};Z=new WeakMap,qe=new WeakSet,qt=function(e){f?e.on("message",t=>{o(this,pe).call(this,e,t)}):e.onmessage=t=>o(this,pe).call(this,e,t.data)},pe=new WeakMap;f&&(globalThis.Worker=M("worker_threads").Worker);var K,U,Y,Je,Jt,Ve,Vt,He,Ht,ye,Re=class extends G{constructor(e){super(),u(this,Je),u(this,Ve),u(this,He),this.close=()=>{},u(this,K,new Map),u(this,U,void 0),u(this,Y,!1),u(this,ye,async(r,n)=>{if(!(!n||!n.type))switch(n.type){case"resolve":this.resolve();return;case"response":this.resolveResponse(n);return;default:this.outputQueue.put(n);return;case"sync-request":{let s=n.data;o(this,K).set(s.data.uuid,s.data.msg);return}case"request":throw new TypeError("Can't send messages of type 'request' from a worker.Use service worker fetch request instead.")}});let t=r=>{P(this,He,Ht).call(this,r),this.close=()=>r.terminate(),P(this,Je,Jt).call(this,`${e.serviceWorkerUrl}webr-serviceworker.js`).then(n=>{let s={type:"init",data:{config:e,channelType:O.ServiceWorker,clientId:n,location:window.location.href}};r.postMessage(s)})};if(V(e.serviceWorkerUrl))De(`${e.serviceWorkerUrl}webr-worker.js`,r=>t(r));else{let r=new Worker(`${e.serviceWorkerUrl}webr-worker.js`);t(r)}({resolve:this.resolve,promise:this.initialised}=J())}activeRegistration(){var e;if(!((e=o(this,U))!=null&&e.active))throw new Error("Attempted to obtain a non-existent active registration.");return o(this,U).active}interrupt(){c(this,Y,!0)}};K=new WeakMap,U=new WeakMap,Y=new WeakMap,Je=new WeakSet,Jt=async function(e){c(this,U,await navigator.serviceWorker.register(e)),await navigator.serviceWorker.ready,window.addEventListener("beforeunload",()=>{var r;(r=o(this,U))==null||r.unregister()});let t=await new Promise(r=>{navigator.serviceWorker.addEventListener("message",function n(s){s.data.type==="registration-successful"&&(navigator.serviceWorker.removeEventListener("message",n),r(s.data.clientId))}),this.activeRegistration().postMessage({type:"register-client-main"})});return navigator.serviceWorker.addEventListener("message",r=>{P(this,Ve,Vt).call(this,r)}),t},Ve=new WeakSet,Vt=async function(e){if(e.data.type==="request"){let t=e.data.data,r=o(this,K).get(t);if(!r)throw new Error("Request not found during service worker XHR request");switch(o(this,K).delete(t),r.type){case"read":{let n=await this.inputQueue.get();this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:t,response:Rt(t,n)});break}case"interrupt":{let n=o(this,Y);this.activeRegistration().postMessage({type:"wasm-webr-fetch-response",uuid:t,response:Rt(t,n)}),c(this,Y,!1);break}default:throw new TypeError(`Unsupported request type '${r.type}'.`)}return}},He=new WeakSet,Ht=function(e){f?e.on("message",t=>{o(this,ye).call(this,e,t)}):e.onmessage=t=>o(this,ye).call(this,e,t.data)},ye=new WeakMap;var O={Automatic:0,SharedArrayBuffer:1,ServiceWorker:2};function Gt(e){switch(e.channelType){case O.SharedArrayBuffer:return new le(e);case O.ServiceWorker:return new Re(e);case O.Automatic:default:if(f||crossOriginIsolated)return new le(e);if("serviceWorker"in navigator&&!V(e.serviceWorkerUrl))return new Re(e);throw new Error("Can't initialise main thread communication channel")}}var $t=f?__dirname+"/":"https://webr.r-wasm.org/v0.1.1/",Xt="https://repo.r-wasm.org";function D(e){return e&&(typeof e=="object"||typeof e=="function")&&"payloadType"in e&&Le(e._payload)}function zt(e){var t;return!!(D(e)&&((t=e._payload.obj.methods)!=null&&t.includes("exec")))}var d={null:0,symbol:1,pairlist:2,closure:3,environment:4,promise:5,call:6,special:7,builtin:8,string:9,logical:10,integer:13,double:14,complex:15,character:16,dots:17,any:18,list:19,expression:20,bytecode:21,pointer:22,weakref:23,raw:24,s4:25,new:30,free:31,function:99};function bt(e){return e&&typeof e=="object"&&Object.keys(d).includes(e.type)}function gt(e){return e&&typeof e=="object"&&"re"in e&&"im"in e}function Ge(e){return i._Rf_protect(k(e)),e}function w(e,t){return i._Rf_protect(k(e)),++t.n,e}function Zt(e){let t=i._malloc(4);return i._R_ProtectWithIndex(k(e),t),{loc:i.getValue(t,"i32"),ptr:t}}function Qt(e){i._Rf_unprotect(1),i._free(e.ptr)}function Kt(e,t){return i._R_Reprotect(k(e),t.loc),e}function _(e){i._Rf_unprotect(e)}function wt(e,t,r){i._Rf_defineVar(k(t),k(r),k(e))}function Yt(e,t){let r={},n={n:0};try{let s=new we(t);w(s,n),r.code=i.allocateUTF8(e);let a=i._R_ParseEvalString(r.code,s.ptr);return R.wrap(a)}finally{Bt(r),_(n.n)}}function ge(e,t){return i.LDSO.loadedLibsByName["/usr/lib/R/library/webr/libs/webr.so"].module.ffi_safe_eval(k(e),k(t))}function k(e){return xr(e)?e.ptr:e}function q(e,t){if(i._TYPEOF(e.ptr)!==d[t])throw new Error(`Unexpected object type "${e.type()}" when expecting type "${t}"`)}function Pr(e){if(bt(e))return new(er(d[e.type]))(e);if(e&&typeof e=="object"&&"type"in e&&e.type==="null")return new Ze;if(e===null)return new F({type:"logical",names:null,values:[null]});if(typeof e=="boolean")return new F(e);if(typeof e=="number")return new Pe(e);if(typeof e=="string")return new A(e);if(gt(e))return new ve(e);if(Array.isArray(e))return vr(e);throw new Error("Robj construction for this JS object is not yet supported")}function vr(e){let t={n:0};try{let r=new B([new C("c"),...e]);return w(r,t),r.eval()}finally{_(t.n)}}var g=class{constructor(e){this.ptr=e}type(){let e=i._TYPEOF(this.ptr);return Object.keys(d).find(t=>d[t]===e)}},te,$e,L=class extends g{constructor(e){if(!(e instanceof g))return Pr(e);super(e.ptr),u(this,te)}static wrap(e){let t=i._TYPEOF(e);return new(er(t))(new g(e))}get[Symbol.toStringTag](){return`RObject:${this.type()}`}static getPersistentObject(e){return v[e]}getPropertyValue(e){return this[e]}inspect(){Yt(".Internal(inspect(x))",{x:this})}isNull(){return i._TYPEOF(this.ptr)===d.null}isUnbound(){return this.ptr===v.unboundValue.ptr}attrs(){return re.wrap(i._ATTRIB(this.ptr))}setNames(e){let t;if(e===null)t=v.null;else if(Array.isArray(e)&&e.every(r=>typeof r=="string"||r===null))t=new A(e);else throw new Error("Argument to setNames must be null or an Array of strings or null");return i._Rf_setAttrib(this.ptr,v.namesSymbol.ptr,t.ptr),this}names(){let e=A.wrap(i._Rf_getAttrib(this.ptr,v.namesSymbol.ptr));return e.isNull()?null:e.toArray()}includes(e){let t=this.names();return t&&t.includes(e)}toJs(e={depth:0},t=1){throw new Error("This R object cannot be converted to JS")}subset(e){return P(this,te,$e).call(this,e,v.bracketSymbol.ptr)}get(e){return P(this,te,$e).call(this,e,v.bracket2Symbol.ptr)}getDollar(e){return P(this,te,$e).call(this,e,v.dollarSymbol.ptr)}pluck(...e){let t=Zt(v.null);try{let r=(s,a)=>{let l=s.get(a);return Kt(l,t)},n=e.reduce(r,this);return n.isNull()?void 0:n}finally{Qt(t)}}set(e,t){let r={n:0};try{let n=new L(e);w(n,r);let s=new L(t);w(s,r);let a=new C("[[<-"),l=i._Rf_lang4(a.ptr,this.ptr,n.ptr,s.ptr);return w(l,r),L.wrap(ge(l,v.baseEnv))}finally{_(r.n)}}static getMethods(e){let t=new Set,r=e;do Object.getOwnPropertyNames(r).map(n=>t.add(n));while(r=Object.getPrototypeOf(r));return[...t.keys()].filter(n=>typeof e[n]=="function")}},R=L;te=new WeakSet,$e=function(e,t){let r={n:0};try{let n=new L(e);w(n,r);let s=i._Rf_lang3(t,this.ptr,n.ptr);return w(s,r),L.wrap(ge(s,v.baseEnv))}finally{_(r.n)}};var Ze=class extends R{constructor(){return super(new g(i.getValue(i._R_NilValue,"*"))),this}toJs(){return{type:"null"}}},C=class extends R{constructor(e){if(e instanceof g){q(e,"symbol"),super(e);return}let t=i.allocateUTF8(e);try{super(new g(i._Rf_install(t)))}finally{i._free(t)}}toJs(){let e=this.toObject();return{type:"symbol",printname:e.printname,symvalue:e.symvalue,internal:e.internal}}toObject(){return{printname:this.printname().isUnbound()?null:this.printname().toString(),symvalue:this.symvalue().isUnbound()?null:this.symvalue().ptr,internal:this.internal().isNull()?null:this.internal().ptr}}toString(){return this.printname().toString()}printname(){return xe.wrap(i._PRINTNAME(this.ptr))}symvalue(){return R.wrap(i._SYMVALUE(this.ptr))}internal(){return R.wrap(i._INTERNAL(this.ptr))}},re=class extends R{constructor(e){if(e instanceof g)return q(e,"pairlist"),super(e),this;let t={n:0};try{let{names:r,values:n}=_e(e),s=re.wrap(i._Rf_allocList(n.length));w(s,t);for(let[a,l]=[0,s];!l.isNull();[a,l]=[a+1,l.cdr()])l.setcar(new R(n[a]));s.setNames(r),super(s)}finally{_(t.n)}}get length(){return this.toArray().length}toArray(e={depth:1}){return this.toJs(e).values}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1,depth:r=1}={}){let n=this.entries({depth:r}),s=n.map(([a,l])=>a);if(!e&&new Set(s).size!==s.length)throw new Error("Duplicate key when converting pairlist without allowDuplicateKey enabled");if(!t&&s.some(a=>!a))throw new Error("Empty or null key when converting pairlist without allowEmptyKey enabled");return Object.fromEntries(n.filter((a,l)=>n.findIndex(p=>p[0]===a[0])===l))}entries(e={depth:1}){let t=this.toJs(e);return t.values.map((r,n)=>[t.names?t.names[n]:null,r])}toJs(e={depth:0},t=1){let r=[],n=!1,s=[];for(let a=this;!a.isNull();a=a.cdr()){let l=a.tag();l.isNull()?r.push(""):(n=!0,r.push(l.toString())),e.depth&&t>=e.depth?s.push(a.car()):s.push(a.car().toJs(e,t+1))}return{type:"pairlist",names:n?r:null,values:s}}includes(e){return e in this.toObject()}setcar(e){i._SETCAR(this.ptr,e.ptr)}car(){return R.wrap(i._CAR(this.ptr))}cdr(){return R.wrap(i._CDR(this.ptr))}tag(){return R.wrap(i._TAG(this.ptr))}},B=class extends R{constructor(e){if(e instanceof g)return q(e,"call"),super(e),this;let t={n:0};try{let{values:r}=_e(e),n=r.map(a=>w(new R(a),t)),s=B.wrap(i._Rf_allocVector(d.call,r.length));w(s,t);for(let[a,l]=[0,s];!l.isNull();[a,l]=[a+1,l.cdr()])l.setcar(n[a]);super(s)}finally{_(t.n)}}setcar(e){i._SETCAR(this.ptr,e.ptr)}car(){return R.wrap(i._CAR(this.ptr))}cdr(){return R.wrap(i._CDR(this.ptr))}eval(){return R.wrap(ge(this.ptr,v.baseEnv))}},Pt=class extends R{constructor(e){if(e instanceof g)return q(e,"list"),super(e),this;let t={n:0};try{let{names:r,values:n}=_e(e),s=i._Rf_allocVector(d.list,n.length);w(s,t),n.forEach((a,l)=>{i._SET_VECTOR_ELT(s,l,new R(a).ptr)}),R.wrap(s).setNames(r),super(new g(s))}finally{_(t.n)}}get length(){return i._LENGTH(this.ptr)}toArray(e={depth:1}){return this.toJs(e).values}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1,depth:r=1}={}){let n=this.entries({depth:r}),s=n.map(([a,l])=>a);if(!e&&new Set(s).size!==s.length)throw new Error("Duplicate key when converting list without allowDuplicateKey enabled");if(!t&&s.some(a=>!a))throw new Error("Empty or null key when converting list without allowEmptyKey enabled");return Object.fromEntries(n.filter((a,l)=>n.findIndex(p=>p[0]===a[0])===l))}entries(e={depth:1}){let t=this.toJs(e);return t.values.map((r,n)=>[t.names?t.names[n]:null,r])}toJs(e={depth:0},t=1){return{type:"list",names:this.names(),values:[...Array(this.length).keys()].map(r=>e.depth&&t>=e.depth?this.get(r+1):this.get(r+1).toJs(e,t+1))}}},ee=class extends R{exec(...e){let t={n:0};try{let r=new B([this,...e]);return w(r,t),r.eval()}finally{_(t.n)}}},xe=class extends R{constructor(e){if(e instanceof g){q(e,"string"),super(e);return}let t=i.allocateUTF8(e);try{super(new g(i._Rf_mkChar(t)))}finally{i._free(t)}}toString(){return i.UTF8ToString(i._R_CHAR(this.ptr))}toJs(){return{type:"string",value:this.toString()}}},we=class extends R{constructor(e={}){if(e instanceof g)return q(e,"environment"),super(e),this;let t=0;try{let{names:r,values:n}=_e(e),s=Ge(i._R_NewEnv(v.globalEnv.ptr,0,0));++t,n.forEach((a,l)=>{let p=r?r[l]:null;if(!p)throw new Error("Can't create object in new environment with empty symbol name");let y=new C(p),x=Ge(new R(a));try{wt(s,y,x)}finally{_(1)}}),super(new g(s))}finally{_(t)}}ls(e=!1,t=!0){return A.wrap(i._R_lsInternal3(this.ptr,Number(e),Number(t))).toArray()}bind(e,t){let r=new C(e),n=Ge(new R(t));try{wt(this,r,n)}finally{_(1)}}names(){return this.ls(!0,!0)}frame(){return R.wrap(i._FRAME(this.ptr))}subset(e){if(typeof e=="number")throw new Error("Object of type environment is not subsettable");return this.getDollar(e)}toObject({depth:e=0}={}){let t=this.names();return Object.fromEntries([...Array(t.length).keys()].map(r=>[t[r],this.getDollar(t[r]).toJs({depth:e})]))}toJs(e={depth:0},t=1){let r=this.names(),n=[...Array(r.length).keys()].map(s=>e.depth&&t>=e.depth?this.getDollar(r[s]):this.getDollar(r[s]).toJs(e,t+1));return{type:"environment",names:r,values:n}}},j=class extends R{constructor(e,t,r){if(e instanceof g)return q(e,t),super(e),this;let n={n:0};try{let{names:s,values:a}=_e(e),l=i._Rf_allocVector(d[t],a.length);w(l,n),a.forEach(r(l)),R.wrap(l).setNames(s),super(new g(l))}finally{_(n.n)}}get length(){return i._LENGTH(this.ptr)}get(e){return super.get(e)}subset(e){return super.subset(e)}getDollar(e){throw new Error("$ operator is invalid for atomic vectors")}detectMissing(){let e={n:0};try{let t=i._Rf_lang2(new C("is.na").ptr,this.ptr);w(t,e);let r=F.wrap(ge(t,v.baseEnv));w(r,e);let n=r.toTypedArray();return Array.from(n).map(s=>!!s)}finally{_(e.n)}}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:e[r])}toObject({allowDuplicateKey:e=!0,allowEmptyKey:t=!1}={}){let r=this.entries(),n=r.map(([s,a])=>s);if(!e&&new Set(n).size!==n.length)throw new Error("Duplicate key when converting atomic vector without allowDuplicateKey enabled");if(!t&&n.some(s=>!s))throw new Error("Empty or null key when converting atomic vector without allowEmptyKey enabled");return Object.fromEntries(r.filter((s,a)=>r.findIndex(l=>l[0]===s[0])===a))}entries(){let e=this.toArray(),t=this.names();return e.map((r,n)=>[t?t[n]:null,r])}toJs(){return{type:this.type(),names:this.names(),values:this.toArray()}}},Qe,vt=class extends j{constructor(e){super(e,"logical",o(vt,Qe))}getBoolean(e){return this.get(e).toArray()[0]}toBoolean(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getBoolean(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS boolean");return e}toTypedArray(){return new Int32Array(i.HEAP32.subarray(i._LOGICAL(this.ptr)/4,i._LOGICAL(this.ptr)/4+this.length))}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:!!e[r])}},F=vt;Qe=new WeakMap,u(F,Qe,e=>{let t=i._LOGICAL(e),r=i.getValue(i._R_NaInt,"i32");return(n,s)=>{i.setValue(t+4*s,n===null?r:!!n,"i32")}});var Ke,xt=class extends j{constructor(e){super(e,"integer",o(xt,Ke))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Int32Array(i.HEAP32.subarray(i._INTEGER(this.ptr)/4,i._INTEGER(this.ptr)/4+this.length))}},Xe=xt;Ke=new WeakMap,u(Xe,Ke,e=>{let t=i._INTEGER(e),r=i.getValue(i._R_NaInt,"i32");return(n,s)=>{i.setValue(t+4*s,n===null?r:Math.round(Number(n)),"i32")}});var Ye,_t=class extends j{constructor(e){super(e,"double",o(_t,Ye))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Float64Array(i.HEAPF64.subarray(i._REAL(this.ptr)/8,i._REAL(this.ptr)/8+this.length))}},Pe=_t;Ye=new WeakMap,u(Pe,Ye,e=>{let t=i._REAL(e),r=i.getValue(i._R_NaReal,"double");return(n,s)=>{i.setValue(t+8*s,n===null?r:n,"double")}});var et,Tt=class extends j{constructor(e){super(e,"complex",o(Tt,et))}getComplex(e){return this.get(e).toArray()[0]}toComplex(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getComplex(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS object");return e}toTypedArray(){return new Float64Array(i.HEAPF64.subarray(i._COMPLEX(this.ptr)/8,i._COMPLEX(this.ptr)/8+2*this.length))}toArray(){let e=this.toTypedArray();return this.detectMissing().map((t,r)=>t?null:{re:e[2*r],im:e[2*r+1]})}},ve=Tt;et=new WeakMap,u(ve,et,e=>{let t=i._COMPLEX(e),r=i.getValue(i._R_NaReal,"double");return(n,s)=>{i.setValue(t+8*(2*s),n===null?r:n.re,"double"),i.setValue(t+8*(2*s+1),n===null?r:n.im,"double")}});var tt,Et=class extends j{constructor(e){super(e,"character",o(Et,tt))}getString(e){return this.get(e).toArray()[0]}toString(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getString(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS string");return e}toTypedArray(){return new Uint32Array(i.HEAPU32.subarray(i._STRING_PTR(this.ptr)/4,i._STRING_PTR(this.ptr)/4+this.length))}toArray(){return this.detectMissing().map((e,t)=>e?null:i.UTF8ToString(i._R_CHAR(i._STRING_ELT(this.ptr,t))))}},A=Et;tt=new WeakMap,u(A,tt,e=>(t,r)=>{t===null?i._SET_STRING_ELT(e,r,v.naString.ptr):i._SET_STRING_ELT(e,r,new xe(t).ptr)});var rt,kt=class extends j{constructor(e){super(e,"raw",o(kt,rt))}getNumber(e){return this.get(e).toArray()[0]}toNumber(){if(this.length!==1)throw new Error("Can't convert atomic vector of length > 1 to a scalar JS value");let e=this.getNumber(1);if(e===null)throw new Error("Can't convert missing value `NA` to a JS number");return e}toTypedArray(){return new Uint8Array(i.HEAPU8.subarray(i._RAW(this.ptr),i._RAW(this.ptr)+this.length))}},ze=kt;rt=new WeakMap,u(ze,rt,e=>{let t=i._RAW(e);return(r,n)=>{i.setValue(t+n,Number(r),"i8")}});function _e(e){return bt(e)?e:Array.isArray(e)?{names:null,values:e}:e&&typeof e=="object"&&!gt(e)?{names:Object.keys(e),values:Object.values(e)}:{names:null,values:[e]}}function er(e){let t={[d.null]:Ze,[d.symbol]:C,[d.pairlist]:re,[d.closure]:ee,[d.environment]:we,[d.call]:B,[d.special]:ee,[d.builtin]:ee,[d.string]:xe,[d.logical]:F,[d.integer]:Xe,[d.double]:Pe,[d.complex]:ve,[d.character]:A,[d.list]:Pt,[d.raw]:ze,[d.function]:ee};return e in t?t[e]:R}function xr(e){return e instanceof R}var v;function Tr(){}function Er(e,t){return async function*(){let r={type:"callRObjectMethod",data:{payload:t._payload,prop:"getPropertyValue",args:[{payloadType:"raw",obj:"length"}],shelter:void 0}},n=await e.request(r);if(typeof n.obj!="number")throw new Error("Cannot iterate over object, unexpected type for length property.");for(let s=1;s<=n.obj;s++)yield t.get(s)}}function tr(e,t,r){return async(...n)=>{let s=n.map(p=>D(p)?p._payload:{obj:E(p,D,y=>y._payload),payloadType:"raw"}),a={type:"callRObjectMethod",data:{payload:r,prop:t,args:s}},l=await e.request(a);switch(l.payloadType){case"ptr":return I(e,l);case"raw":return E(l,Le,(p,y)=>I(y,p),e).obj}}}async function kr(e,t,r,n){let s={type:"newRObject",data:{objType:t,obj:E(n,D,l=>l._payload),shelter:r}},a=await e.request(s);switch(a.payloadType){case"raw":throw new Error("Unexpected raw payload type returned from newRObject");case"ptr":return I(e,a)}}function I(e,t){var r;let n=new Proxy((r=t.obj.methods)!=null&&r.includes("exec")?Object.assign(Tr,{...t}):t,{get:(s,a)=>{var l;if(a==="_payload")return t;if(a===Symbol.asyncIterator)return Er(e,n);if((l=t.obj.methods)!=null&&l.includes(a.toString()))return tr(e,a.toString(),t)},apply:async(s,a,l)=>{let p=await I(e,t).exec(...l);return zt(p)?p:p.toJs()}});return n}function T(e,t,r){return new Proxy(R,{construct:(n,s)=>kr(e,r,t,...s),get:(n,s)=>tr(e,s.toString())})}var Te,Ee,ke,We,nt,st,ot,at,it,rr,Wt=class{constructor(e={},t={REnv:{R_HOME:"/usr/lib/R",R_ENABLE_JIT:"0",R_DEFAULT_DEVICE:"canvas"}}){u(this,it),u(this,Te,void 0),u(this,Ee,void 0),u(this,ke,void 0),u(this,We,void 0),u(this,nt,r=>{console.log(r)}),u(this,st,r=>{console.error(r)}),u(this,ot,r=>{let n=prompt(r);n&&this.stdin(`${n}
`)}),u(this,at,r=>{if(f)throw new Error("Plotting with HTML canvas is not yet supported under Node");Function(`this.getContext('2d').${r}`).bind(this.canvas)()}),this.webR=new lt(t),f||(this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width","1008"),this.canvas.setAttribute("height","1008")),c(this,Te,e.stdout||o(this,nt)),c(this,Ee,e.stderr||o(this,st)),c(this,ke,e.prompt||o(this,ot)),c(this,We,e.canvasExec||o(this,at))}stdin(e){this.webR.writeConsole(e)}interrupt(){this.webR.interrupt()}run(){P(this,it,rr).call(this)}};Te=new WeakMap,Ee=new WeakMap,ke=new WeakMap,We=new WeakMap,nt=new WeakMap,st=new WeakMap,ot=new WeakMap,at=new WeakMap,it=new WeakSet,rr=async function(){for(;;){let e=await this.webR.read();switch(e.type){case"stdout":o(this,Te).call(this,e.data);break;case"stderr":o(this,Ee).call(this,e.data);break;case"prompt":o(this,ke).call(this,e.data);break;case"canvasExec":o(this,We).call(this,e.data);break;default:console.warn(`Unhandled output type for webR Console: ${e.type}.`)}}};var Wr={R_HOME:"/usr/lib/R",R_ENABLE_JIT:"0"},Sr={RArgs:[],REnv:Wr,baseUrl:$t,serviceWorkerUrl:"",repoUrl:Xt,homedir:"/home/web_user",interactive:!0,channelType:O.Automatic},b,lt=class{constructor(e={}){u(this,b,void 0),this.FS={lookupPath:async r=>{let n={type:"lookupPath",data:{path:r}};return(await o(this,b).request(n)).obj},mkdir:async r=>{let n={type:"mkdir",data:{path:r}};return(await o(this,b).request(n)).obj},readFile:async(r,n)=>{let s={type:"readFile",data:{path:r,flags:n}};return(await o(this,b).request(s)).obj},rmdir:async r=>{let n={type:"rmdir",data:{path:r}};await o(this,b).request(n)},writeFile:async(r,n,s)=>{let a={type:"writeFile",data:{path:r,data:n,flags:s}};await o(this,b).request(a)},unlink:async r=>{let n={type:"unlink",data:{path:r}};await o(this,b).request(n)}};let t=Object.assign(Sr,e);c(this,b,Gt(t)),this.objs={},this.Shelter=Or(o(this,b))}async init(){let e=await o(this,b).initialised;return this.globalShelter=await new this.Shelter,this.RObject=this.globalShelter.RObject,this.RLogical=this.globalShelter.RLogical,this.RInteger=this.globalShelter.RInteger,this.RDouble=this.globalShelter.RDouble,this.RComplex=this.globalShelter.RComplex,this.RCharacter=this.globalShelter.RCharacter,this.RRaw=this.globalShelter.RRaw,this.RList=this.globalShelter.RList,this.RPairlist=this.globalShelter.RPairlist,this.REnvironment=this.globalShelter.REnvironment,this.RSymbol=this.globalShelter.RSymbol,this.RString=this.globalShelter.RString,this.RCall=this.globalShelter.RCall,this.objs={baseEnv:await this.RObject.getPersistentObject("baseEnv"),globalEnv:await this.RObject.getPersistentObject("globalEnv"),null:await this.RObject.getPersistentObject("null"),true:await this.RObject.getPersistentObject("true"),false:await this.RObject.getPersistentObject("false"),na:await this.RObject.getPersistentObject("na")},e}close(){o(this,b).close()}async read(){return await o(this,b).read()}async flush(){return await o(this,b).flush()}write(e){o(this,b).write(e)}writeConsole(e){this.write({type:"stdin",data:e+`
`})}interrupt(){o(this,b).interrupt()}async installPackages(e){for(let t of e){let r={type:"installPackage",data:{name:t}};await o(this,b).request(r)}}async destroy(e){await this.globalShelter.destroy(e)}async evalR(e,t){return this.globalShelter.evalR(e,t)}async evalRVoid(e,t){return this.evalRRaw(e,"void",t)}async evalRBoolean(e,t){return this.evalRRaw(e,"boolean",t)}async evalRNumber(e,t){return this.evalRRaw(e,"number",t)}async evalRString(e,t){return this.evalRRaw(e,"string",t)}async evalRRaw(e,t,r={}){let n=E(r,D,l=>l._payload),s={type:"evalRRaw",data:{code:e,options:n,outputType:t}},a=await o(this,b).request(s);switch(a.payloadType){case"raw":return a.obj;case"ptr":throw new Error("Unexpected ptr payload type returned from evalRVoid")}}};b=new WeakMap;var m,h,Se,pt=class{constructor(e){u(this,m,""),u(this,h,void 0),u(this,Se,!1),c(this,h,e)}async init(){if(o(this,Se))return;let e={type:"newShelter"},t=await o(this,h).request(e);c(this,m,t.obj),this.RObject=T(o(this,h),o(this,m),"object"),this.RLogical=T(o(this,h),o(this,m),"logical"),this.RInteger=T(o(this,h),o(this,m),"integer"),this.RDouble=T(o(this,h),o(this,m),"double"),this.RComplex=T(o(this,h),o(this,m),"complex"),this.RCharacter=T(o(this,h),o(this,m),"character"),this.RRaw=T(o(this,h),o(this,m),"raw"),this.RList=T(o(this,h),o(this,m),"list"),this.RPairlist=T(o(this,h),o(this,m),"pairlist"),this.REnvironment=T(o(this,h),o(this,m),"environment"),this.RSymbol=T(o(this,h),o(this,m),"symbol"),this.RString=T(o(this,h),o(this,m),"string"),this.RCall=T(o(this,h),o(this,m),"call"),c(this,Se,!0)}async purge(){let e={type:"shelterPurge",data:o(this,m)};await o(this,h).request(e)}async destroy(e){let t={type:"shelterDestroy",data:{id:o(this,m),obj:e._payload}};await o(this,h).request(t)}async size(){let e={type:"shelterSize",data:o(this,m)};return(await o(this,h).request(e)).obj}async evalR(e,t={}){let r=E(t,D,a=>a._payload),n={type:"evalR",data:{code:e,options:r,shelter:o(this,m)}},s=await o(this,h).request(n);switch(s.payloadType){case"raw":throw new Error("Unexpected payload type returned from evalR");default:return I(o(this,h),s)}}async captureR(e,t={}){let r=E(t,D,a=>a._payload),n={type:"captureR",data:{code:e,options:r,shelter:o(this,m)}},s=await o(this,h).request(n);switch(s.payloadType){case"ptr":throw new Error("Unexpected payload type returned from evalR");case"raw":{let a=s.obj,l=I(o(this,h),a.result),p=a.output;for(let y=0;y<p.length;++y)p[y].type!=="stdout"&&p[y].type!=="stderr"&&(p[y].data=I(o(this,h),p[y].data));return{result:l,output:p}}}}};m=new WeakMap,h=new WeakMap,Se=new WeakMap;function Or(e){return new Proxy(pt,{construct:async()=>{let t=new pt(e);return await t.init(),t}})}const ____slug__vue_vue_type_style_index_0_lang="",_sfc_main={data(){return{command:"",pos:0,data:"",path:null,shelter:null,tab:null,editorStarted:!1}},async setup(){const route=useRoute(),id=ref(route.query.id?route.query.id:""),path=route.path+id.value,store=useCommandStore(),{command}=storeToRefs(store),webRConsole=new Wt({stdout:e=>document.getElementById("out").append(e+`
`),stderr:e=>document.getElementById("out").append(e+`
`),prompt:e=>document.getElementById("out").append(e),canvasExec:line=>{eval(`document.getElementById("plot-canvas").getContext('2d').${line}`)}}),tutosList=await queryContent(path).find();for(var i=tutosList.length-1;i>=0;i--)(tutosList[i]._path==path+"_dir"||tutosList[i]._path==path+"/_dir")&&tutosList.splice(i,1);return{webRConsole,tutosList,store,command}},async mounted(){await this.webRConsole.run(),this.data=this.tutosList[this.pos]},methods:{async getOutput(){for(;;){const e=await this.webR.read();switch(e.type){case"stdout":this.stdout.push(e.data);break;case"stderr":this.stderr=this.srdout+e.data;break;default:console.warn(`Unhandled output type: ${e.type}.`)}}},async onEnter(){this.webRConsole.stdin(this.command),document.getElementById("out").append(this.command+`
`),this.command=""},async nextBtn(){this.pos<this.tutosList.length&&(this.pos=this.pos+1,this.data=this.tutosList[this.pos])},async prevBtn(){this.pos>0&&(this.pos=this.pos-1,this.data=this.tutosList[this.pos])}},watch:{command(e){if(this.store.changed){for(const t of this.store.command)this.webRConsole.stdin(t),document.getElementById("out").append(t+`
`);this.store.reset()}}}},_hoisted_1={class:"prose"},_hoisted_2=createBaseVNode("br",null,null,-1),_hoisted_3={style:{height:"50%"}},_hoisted_4=createBaseVNode("pre",null,[createBaseVNode("code",{id:"out"},"Loading webR, please wait...")],-1),_hoisted_5={style:{height:"50%"}},_hoisted_6=createBaseVNode("canvas",{id:"plot-canvas",width:"1008",height:"1008",style:{margin:"auto",height:"calc(100% - 50px)"}},null,-1);function _sfc_render(e,t,r,n,s,a){const l=_sfc_main$2,p=_sfc_main$3,y=resolveComponent("v-card-text"),x=resolveComponent("v-btn"),$=resolveComponent("v-chip"),ae=resolveComponent("v-card-actions"),Q=resolveComponent("v-card"),z=resolveComponent("v-col"),ie=resolveComponent("v-textarea"),X=resolveComponent("v-tab"),ue=resolveComponent("v-tabs"),ne=resolveComponent("v-window-item"),ce=__nuxt_component_2,he=resolveComponent("v-window"),de=resolveComponent("v-row");return openBlock(),createBlock(de,{class:"fill-height"},{default:withCtx(()=>[createVNode(z,{class:"fill-height overflow-y-auto"},{default:withCtx(()=>[createVNode(Q,{class:"fill-height"},{default:withCtx(()=>[createVNode(y,{class:"fill-height overflow-y-auto",style:{"max-height":"calc(100% - 50px)"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[s.data?(openBlock(),createBlock(p,{value:s.data,key:s.data._path},{default:withCtx(()=>[createBaseVNode("h1",null,toDisplayString(s.data.title),1),_hoisted_2,createVNode(l,{value:s.data.body},null,8,["value"])]),_:1},8,["value"])):createCommentVNode("",!0)])]),_:1}),createVNode(ae,{class:"d-flex justify-end",style:{"background-color":"lightsteelblue"}},{default:withCtx(()=>[createVNode(x,{disabled:s.pos==0,onClick:a.prevBtn},{default:withCtx(()=>[createTextVNode("Prev")]),_:1},8,["disabled","onClick"]),createVNode(x,{disabled:s.pos==n.tutosList.length-1,onClick:a.nextBtn,class:"me-2"},{default:withCtx(()=>[createTextVNode("Next")]),_:1},8,["disabled","onClick"]),createVNode($,null,{default:withCtx(()=>[createTextVNode(toDisplayString(s.pos+1)+" / "+toDisplayString(n.tutosList.length),1)]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(z,{class:"fill-height"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_3,[createVNode(Q,{class:"fill-height"},{default:withCtx(()=>[createVNode(y,{class:"fill-height overflow-y-auto"},{default:withCtx(()=>[_hoisted_4,createVNode(ie,{onKeyup:withKeys(a.onEnter,["enter"]),modelValue:n.command,"onUpdate:modelValue":t[0]||(t[0]=N=>n.command=N),variant:"underlined","prepend-icon":"mdi-chevron-right"},null,8,["onKeyup","modelValue"])]),_:1})]),_:1})]),createBaseVNode("div",_hoisted_5,[createVNode(Q,{class:"fill-height pa-2 mt-1"},{default:withCtx(()=>[createVNode(ue,{modelValue:s.tab,"onUpdate:modelValue":t[1]||(t[1]=N=>s.tab=N)},{default:withCtx(()=>[createVNode(X,{value:"plot"},{default:withCtx(()=>[createTextVNode("Plot")]),_:1}),createVNode(X,{value:"editorTab"},{default:withCtx(()=>[createTextVNode("Editor")]),_:1})]),_:1},8,["modelValue"]),createVNode(y,{class:"fill-height"},{default:withCtx(()=>[createVNode(he,{modelValue:s.tab,"onUpdate:modelValue":t[2]||(t[2]=N=>s.tab=N),class:"fill-height"},{default:withCtx(()=>[createVNode(ne,{value:"plot",class:"fill-height text-center"},{default:withCtx(()=>[_hoisted_6]),_:1}),createVNode(ne,{value:"editorTab",class:"fill-height text-center"},{default:withCtx(()=>[createVNode(ce)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1})}const ____slug_=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{____slug_ as default};
